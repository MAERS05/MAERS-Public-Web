# MAERS AI å¼€å‘æŒ‡å— (AI Development Guide)

æœ¬æ–‡æ¡£ä¸º AI è¾…åŠ©å¼€å‘æä¾›é¡¹ç›®ä¸Šä¸‹æ–‡æŠ•å–‚æ¸…å•ï¼Œå¸®åŠ© AI å¿«é€Ÿç†è§£é¡¹ç›®ç»“æ„å¹¶ç”Ÿæˆå‡†ç¡®çš„ä»£ç ã€‚

### ğŸ“– æœ¬æ–‡ç›®å½•

- [ğŸ“‹ é¡¹ç›®æ ¸å¿ƒä¿¡æ¯](#-é¡¹ç›®æ ¸å¿ƒä¿¡æ¯)
- [ğŸ—‚ï¸ é¡¹ç›®ç»“æ„ï¼ˆ2026-01-17 æœ€æ–°ï¼‰](#-é¡¹ç›®ç»“æ„2026-01-17-æœ€æ–°)
- [ğŸ”‘ å…³é”®æ¦‚å¿µ](#-å…³é”®æ¦‚å¿µ)
- [ğŸ“ å¸¸è§å¼€å‘åœºæ™¯](#-å¸¸è§å¼€å‘åœºæ™¯)
- [ğŸ” æœç´¢åŠŸèƒ½æ¶æ„](#-æœç´¢åŠŸèƒ½æ¶æ„)
- [ğŸ¯ ç»™ AI çš„å…³é”®æç¤º](#-ç»™-ai-çš„å…³é”®æç¤º)
- [ğŸ“Œ é‡è¦çº¦å®š](#-é‡è¦çº¦å®š)
- [ğŸš€ å¿«é€Ÿä¸Šæ‰‹ AI æç¤ºè¯æ¨¡æ¿](#-å¿«é€Ÿä¸Šæ‰‹-ai-æç¤ºè¯æ¨¡æ¿)

---

## ğŸ“‹ é¡¹ç›®æ ¸å¿ƒä¿¡æ¯

### åŸºæœ¬ä¿¡æ¯
- **é¡¹ç›®åç§°**: MAERS Personal Web
- **æŠ€æœ¯æ ˆ**: 
  - å‰ç«¯: åŸç”Ÿ HTML/CSS/JavaScript (æ— æ¡†æ¶)
  - åç«¯: Python 3.8+ (æ ‡å‡†åº“ + SQLite)
- **æ¶æ„æ¨¡å¼**: é™æ€ä¼˜å…ˆ + åŠ¨æ€ç®¡ç†
- **å‘½åç©ºé—´**: æ‰€æœ‰åŠŸèƒ½æŒ‚è½½åˆ° `window.MAERS.*`

### æ ¸å¿ƒç†å¿µ
1. **æ— æ¡†æ¶ä¾èµ–** - ä¸ä½¿ç”¨ React/Vue/Angular
2. **é›¶æ„å»ºå·¥å…·** - ä¸ä½¿ç”¨ Webpack/Vite
3. **JSå°è£…JSON** - æ•°æ®ä»¥ `.js` æ–‡ä»¶å½¢å¼æä¾›ï¼Œè€Œé `.json`
4. **æœ¬åœ°å¯è¿è¡Œ** - åŒå‡» HTML å³å¯æ‰“å¼€ï¼ˆfile:// åè®®ï¼‰

---

## ğŸ—‚ï¸ é¡¹ç›®ç»“æ„ï¼ˆ2026-01-17 æœ€æ–°ï¼‰

```
MAERS-Personal-Web/
â”œâ”€â”€ _è¯´æ˜/              # ğŸ“š é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ _studio/            # âš™ï¸ Python åç«¯
â”‚   â”œâ”€â”€ server.py       # HTTP æœåŠ¡å…¥å£
â”‚   â”œâ”€â”€ routes.py       # è·¯ç”±åˆ†å‘
â”‚   â””â”€â”€ services/       # ä¸šåŠ¡é€»è¾‘å±‚
â”‚       â”œâ”€â”€ cms.py      # ç¬”è®°/æ–‡å­¦/è®°å½•
â”‚       â”œâ”€â”€ album.py    # ç›¸å†Œç®¡ç†
â”‚       â”œâ”€â”€ music.py    # éŸ³ä¹ç®¡ç†
â”‚       â””â”€â”€ bili.py     # Bç«™è§†é¢‘ä¿¡æ¯è·å–
â”œâ”€â”€ data/               # ğŸ’¾ æ•°æ®å­˜å‚¨
â”‚   â”œâ”€â”€ cms.db          # SQLite - ç¬”è®°æ•°æ®
â”‚   â”œâ”€â”€ gallery.db      # SQLite - ç›¸å†Œæ•°æ®
â”‚   â”œâ”€â”€ music-data.json # JSON - éŸ³ä¹æ•°æ®
â”‚   â”œâ”€â”€ notes-tree.js   # è‡ªåŠ¨ç”Ÿæˆçš„é™æ€æ•°æ®
â”‚   â””â”€â”€ photos-data.js  # è‡ªåŠ¨ç”Ÿæˆçš„é™æ€æ•°æ®
â”œâ”€â”€ custom/             # ğŸ¨ æ¨¡å—åŒ–ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ album/          # ç›¸å†Œæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ album-view.js
â”‚   â”‚   â””â”€â”€ album-admin.js
â”‚   â”œâ”€â”€ cms/            # ç¬”è®°æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ cms-view.js
â”‚   â”‚   â”œâ”€â”€ cms-editor.js
â”‚   â”‚   â””â”€â”€ cms-drag.js
â”‚   â””â”€â”€ music/          # éŸ³ä¹æ¨¡å—
â”‚       â”œâ”€â”€ music-ui.js
â”‚       â”œâ”€â”€ music-player.js
â”‚       â”œâ”€â”€ music-render.js
â”‚       â”œâ”€â”€ music-control.js
â”‚       â”œâ”€â”€ music-drag.js
â”‚       â””â”€â”€ music-state.js
â”œâ”€â”€ data-manage/        # ğŸ“Š æ•°æ®æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ api-client.js
â”‚   â”œâ”€â”€ data-provider.js
â”‚   â”œâ”€â”€ cms-controller.js
â”‚   â”œâ”€â”€ album-controller.js
â”‚   â”œâ”€â”€ admin-core.js
â”‚   â””â”€â”€ music-admin.js
â”œâ”€â”€ shared/             # ğŸ”§ é€šç”¨å·¥å…·
â”‚   â”œâ”€â”€ utils.js        # å·¥å…·å‡½æ•°ï¼ˆå«æœç´¢ã€æ‹¼éŸ³åŒ¹é…ï¼‰
â”‚   â”œâ”€â”€ namespace.js    # å‘½åç©ºé—´å®šä¹‰
â”‚   â”œâ”€â”€ templates.js    # HTML æ¨¡æ¿
â”‚   â””â”€â”€ toast.js        # æç¤ºæ¡†
â”œâ”€â”€ static-style/       # ğŸ¨ CSS æ ·å¼
â”‚   â”œâ”€â”€ theme.css       # ä¸»é¢˜å˜é‡
â”‚   â”œâ”€â”€ components.css  # é€šç”¨ç»„ä»¶
â”‚   â””â”€â”€ html/           # é¡µé¢ç‰¹å®šæ ·å¼
â”œâ”€â”€ dynamic-style/      # âš¡ åŠ¨æ€é…ç½®
â”‚   â””â”€â”€ modules.json    # æ¨¡å—é…ç½®
â””â”€â”€ *.html              # ğŸ“„ é¡µé¢å…¥å£
```

---

## ğŸ”‘ å…³é”®æ¦‚å¿µ

### 1. å‘½åç©ºé—´æ¨¡å¼

```javascript
// æ‰€æœ‰åŠŸèƒ½éƒ½æŒ‚è½½åˆ° MAERS å‘½åç©ºé—´ä¸‹
window.MAERS = window.MAERS || {};

// æ¨¡å—ç»„ç»‡
MAERS.Utils = {};          // é€šç”¨å·¥å…·
MAERS.CMS = {};            // CMS æ¨¡å—
MAERS.Music = {};          // éŸ³ä¹æ¨¡å—
MAERS.Album = {};          // ç›¸å†Œæ¨¡å—
MAERS.Admin = {};          // ç®¡ç†åŠŸèƒ½

// è°ƒç”¨ç¤ºä¾‹
MAERS.Utils.Search.filterNodes(tree, "å…³é”®è¯");
MAERS.Admin.exportModules();
```

### 2. JSå°è£…JSONæ¨¡å¼

```javascript
// åç«¯ç”Ÿæˆçš„æ•°æ®æ–‡ä»¶æ ¼å¼
// data/notes-tree.js
window.MAERS_DATA = {
  "root": [
    {"id": "1", "title": "ç¬”è®°1", "children": []}
  ]
};

// å‰ç«¯ç›´æ¥ä½¿ç”¨
<script src="data/notes-tree.js"></script>
<script>
  const data = window.MAERS_DATA;
</script>
```

### 3. åŒç¯å¢ƒæ¶æ„

- **æœ¬åœ°ç¯å¢ƒ** (`localhost`): å¯ä»¥è°ƒç”¨ Python API è¿›è¡Œç®¡ç†
- **é™æ€éƒ¨ç½²**: ä»…è¯»å–é¢„ç”Ÿæˆçš„ JS æ–‡ä»¶

```javascript
// data-provider.js ä¸­çš„ç¯å¢ƒåˆ¤æ–­
const isLocal = window.location.hostname === 'localhost';
if (isLocal && window.IS_ADMIN) {
    // è°ƒç”¨ API
} else {
    // è¯»å–é™æ€ JS
}
```

---

## ğŸ“ å¸¸è§å¼€å‘åœºæ™¯

### åœºæ™¯1: æ·»åŠ æ–°çš„ CMS åŠŸèƒ½

**éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶ï¼š**
1. `custom/cms/cms-view.js` - UI æ¸²æŸ“é€»è¾‘
2. `data-manage/cms-controller.js` - æ•°æ®æ§åˆ¶
3. `_studio/services/cms.py` - åç«¯é€»è¾‘

**å‘½åç©ºé—´ï¼š** `MAERS.CMS.*`

### åœºæ™¯2: ä¿®æ”¹æ ·å¼

**éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶ï¼š**
1. `static-style/theme.css` - å…¨å±€å˜é‡ï¼ˆé¢œè‰²ã€å­—ä½“ï¼‰
2. `static-style/html/*.css` - é¡µé¢ç‰¹å®šæ ·å¼
3. `static-style/components.css` - ç»„ä»¶æ ·å¼

### åœºæ™¯3: æ·»åŠ æ–°çš„ API æ¥å£

**éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶ï¼š**
1. `_studio/routes.py` - æ·»åŠ è·¯ç”±
2. `_studio/services/*.py` - å®ç°ä¸šåŠ¡é€»è¾‘
3. `data-manage/*-controller.js` - å‰ç«¯è°ƒç”¨

---

## ğŸ” æœç´¢åŠŸèƒ½æ¶æ„

**ä½ç½®**: `shared/utils.js` ä¸­çš„ `MAERS.Utils.Search`

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- æ‹¼éŸ³æœç´¢ (`getPinyinInitials`)
- èŠ‚ç‚¹æŸ¥æ‰¾ (`findNode`, `findPath`)
- æ ‘è¿‡æ»¤ (`filterNodes`)
- æ ‡ç­¾ç­›é€‰ (`collectTags`)

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```javascript
// æ‹¼éŸ³æœç´¢
const pinyin = MAERS.Utils.Search.getPinyinInitials("ä¸­æ–‡");

// è¿‡æ»¤æ ‘
const filtered = MAERS.Utils.Search.filterNodes(tree, "å…³é”®è¯");
```

---

## ğŸ¯ ç»™ AI çš„å…³é”®æç¤º

### ä»£ç é£æ ¼
1. **ä½¿ç”¨å‘½åç©ºé—´** - ä¸ç›´æ¥å®šä¹‰å…¨å±€å‡½æ•°
2. **å‚æ•°åŒ–é…ç½®** - ä½¿ç”¨ CSS å˜é‡å’Œ JSON é…ç½®
3. **é˜²å¾¡æ€§ç¼–ç¨‹** - æ·»åŠ å‚æ•°æ ¡éªŒå’Œé”™è¯¯å¤„ç†

### æ–‡ä»¶è·¯å¾„
- âœ… æ­£ç¡®: `custom/cms/cms-view.js`
- âŒ é”™è¯¯: `custom/cms-view.js` (æ—§ç»“æ„)

### HTML äº‹ä»¶å¤„ç†
```html
<!-- æ­£ç¡®ï¼šä½¿ç”¨å‘½åç©ºé—´ -->
<button onclick="MAERS.Admin.exportModules()">å¯¼å‡º</button>

<!-- é”™è¯¯ï¼šç›´æ¥è°ƒç”¨å…¨å±€å‡½æ•° -->
<button onclick="exportModules()">å¯¼å‡º</button>
```

### æ•°æ®ç®¡ç†å±‚
- `data-manage/` ç›®å½•åŒ…å«æ‰€æœ‰æ§åˆ¶å™¨é€»è¾‘
- `admin-core.js` - åå°æ ¸å¿ƒç®¡ç†
- `music-admin.js` - éŸ³ä¹ç®¡ç†
- `cms-controller.js` - CMS æ§åˆ¶
- `album-controller.js` - ç›¸å†Œæ§åˆ¶

---

## ğŸ“Œ é‡è¦çº¦å®š

### 1. æ•°æ®åŒæ­¥æœºåˆ¶
```python
# åç«¯æ¯æ¬¡ä¿®æ”¹æ•°æ®åï¼Œéƒ½è¦é‡æ–°ç”Ÿæˆé™æ€ JS
def sync_js_file(module_name, data):
    js_content = f"window.MAERS_DATA = {json.dumps(data)};"
    with open(f"data/{module_name}-tree.js", "w", encoding="utf-8") as f:
        f.write(js_content)
```

### 2. å®‰å…¨æ€§
- å‰ç«¯ä½¿ç”¨ `escapeHtml()` è½¬ä¹‰è¾“å…¥
- åç«¯ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢ SQL æ³¨å…¥
- åå°åŠŸèƒ½ä»…åœ¨ `localhost` å¯ç”¨

### 3. æ€§èƒ½ä¼˜åŒ–
- å›¾ç‰‡è‡ªåŠ¨å‹ç¼©ä¸º AVIF/WebP
- ä½¿ç”¨ `defer` åŠ è½½éå…³é”®è„šæœ¬
- ç€‘å¸ƒæµä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ï¼ˆè®¡åˆ’ä¸­ï¼‰

---

## ğŸš€ å¿«é€Ÿä¸Šæ‰‹ AI æç¤ºè¯æ¨¡æ¿

```
æˆ‘åœ¨å¼€å‘ MAERS é¡¹ç›®ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäºåŸç”Ÿ JS å’Œ Python çš„ä¸ªäººç½‘ç«™ã€‚

é¡¹ç›®ä½¿ç”¨å‘½åç©ºé—´æ¨¡å¼ï¼Œæ‰€æœ‰åŠŸèƒ½æŒ‚è½½åˆ° window.MAERS.*ã€‚
ç›®å½•ç»“æ„ï¼šcustom/ ä¸‹æŒ‰æ¨¡å—åˆ†ç»„ï¼ˆalbum/, cms/, music/ï¼‰ã€‚

è¯·å¸®æˆ‘ [å…·ä½“éœ€æ±‚]ï¼Œæ³¨æ„ï¼š
1. ä½¿ç”¨ MAERS.* å‘½åç©ºé—´
2. æ–‡ä»¶è·¯å¾„ä¸º custom/[æ¨¡å—]/[æ–‡ä»¶].js
3. éµå¾ªé¡¹ç›®çš„ä»£ç é£æ ¼
```

---

**æœ€åæ›´æ–°**: 2026-01-17  
**ç‰ˆæœ¬**: v2.7ï¼ˆç›®å½•ç»“æ„é‡æ„åï¼‰
