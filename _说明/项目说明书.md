# MAERS - Personal Web Ecosystem

MAERS 是一个追求极致轻量、原生体验的个人数字花园生态系统。它集成了博客内容管理 (CMS)、数字相册、音乐播放器和个人档案于一体，完全基于原生 Web 技术构建。

---

## 📋 目录 (Table of Contents)

1. [项目简介](#1-项目简介)
2. [核心功能](#2-核心功能)
3. [技术架构](#3-技术架构)
4. [文档索引](#4-文档索引)
5. [运行与部署](#5-运行与部署)
6. [管理员指南](#6-管理员指南)

---

## 1. 项目简介

MAERS 旨在解决现代前端开发日益臃肿的问题。它摒弃了 React/Vue 等重型框架，回归 Web 本源。

- **哲学**: Write Less, Do More. Zero Dependencies.
- **目标**: 提供一个既能作为极速静态网站展示，又能作为强大 CMS 管理内容的双模系统。
-   **状态**: 2026-02-12 已发布 **v5.0**。实现了 **CMS 标签系统 3.0**、**原子化通知** 及 **原生图像懒加载重构**。内容与架构完全分离。


---

## 2. 核心功能

### 📝 CMS (内容管理系统)
- **文件驱动架构**: 数据库仅存储索引，正文全面转为 `.md` 文件存储。支持本地工具（VS Code/Typora）直接操作。
- **延迟加载**: 访客端按需请求文件内容，首屏速度大幅提升。
- **层级管理**: 支持无限层级的文件夹结构的笔记整理，目录名与文件名实时同步。
- **拖拽排序**: 文件夹和文件支持直观的拖拽排序。
- **标签系统**: 强大的标签过滤与分类检索。分类配置（Categories）采用 JSON 文件驱动，实现逻辑与配置的彻底分离。

### 🖼️ Album (相册)
- **瀑布流布局**: 自适应多列瀑布流展示。
- **高性能灯箱**: 支持缩放、平移、键盘导航的沉浸式图片查看器。
- **多级存储**: 自动生成 AVIF (高清预览) 和 WebP (列表缩略) 格式。
- **标签管理**: 支持与 CMS 统一的标签筛选系统（API + 适配器模式）。

### 🎵 Music (音乐播放器)
- **全局吸底**: 页面跳转不中断播放（状态持久化）。
- **画中画 (PiP)**: 支持悬浮窗歌词显示。
- **可视化**: 基于 Canvas 的音频频谱可视化。

### 📚 Literature (文学)
- **Flow Engine 2.0 (流动引擎)**: 参数化自适应 3D 流动路径，实现海量书籍的稳定、无闪烁漫游体验。
- **虚拟滚动**: 彻底平衡物理间距与视口回路，确保流畅的循环滚动。
- **沉浸阅读**: 专注的 Markdown 阅读器，支持全屏沉浸模式与标签过滤。

### 🎮 Games (游戏库)
- **可视化管理**: 完整的后台管理支持，包括游戏封面上传、拖拽排序及元数据编辑。
- **数据同步**: 基于 CMS 核心，与 Notes/Literature 共享标签系统，同时保持独立的数据文件存储。

### 🎨 Theme (主题系统)
- **智能深色模式**: 根据系统设置或时间自动切换。
- **防闪烁 (Flash Guard)**: 独特的同步加载策略，彻底消除 FOUC。
- **缩放视图**: 支持全局 UI 缩放 (Shrink Mode)。

### 🚀 Deployment (部署与更新)
- **静态部署**: 原生支持 GitHub Pages / Vercel / Netlify 纯静态部署。
- **自动版本控制**: 内置 Service Worker 自动更新机制。只需修改 `maers-version-controller.js` 版本号，即可穿透 CDN 强制全站更新，告别手动清缓存。

---

## 3. 技术架构

### 前端 (Frontend)
- **语言**: ES6+ JavaScript (Modules `import/export`)
- **架构**: **Zero Global Pollution** (业务逻辑零全局挂载) + Dependency Injection (依赖注入)
- **样式**: CSS3 Variables, Grid, Flexbox (BEM 命名规范)
- **数据**: Fetch API + JSON
- **无构建**: 无 Webpack/Vite，直接运行源代码。

### 后端 (Backend - Admin Only)
- **语言**: Python 3.8+
- **核心**: `_studio/` 目录下的 Python 引擎
- **框架**: Native http.server (无依赖)
- **数据库**: SQLite (`cms.db`, `gallery.db`)
- **内容存储**: 基于本地文件系统的 Markdown 文档 (`.md`) 存储。

---

## 4. 文档索引
本目录 (`_说明/`) 下包含更多详细技术文档：

| 文档 | 说明 |
| :--- | :--- |
| **[前端开发指南](前端开发指南.md)** | Code Style, ES6 模块规范, CSS 架构 |
| **[后端开发指南](后端开发指南.md)** | Python 原生架构, SQLite 数据库, API 接口 |
| **[AI开发指南](AI开发指南.md)** | 🤖 专为 AI 助手（Cursor/Copilot）准备的上下文规则 |
| **[文件功能说明](文件功能说明.md)** | 🗺️ 全站文件功能字典 (File Map) |
| **[架构决策记录](架构决策记录.md)** | (ADR) 记录关键技术选型的背景与理由 |
| **[细节设计说明](细节设计说明.md)** | 特定复杂功能（如 Flow Engine, Flash Guard）的深度解析 |
| **[项目更新日志](项目更新日志.md)** | 📅 版本迭代历史 |

---

## 5. 运行与部署

### 5.1 访客模式 (Viewer Mode)
只需静态 HTTP 服务器即可运行。

### 5.2 管理模式 (Admin Mode)
这是 MAERS 的完全体，必须启动 `_studio` 引擎。

1. **安装依赖**:
   ```bash
   pip install pillow
   ```
2. **启动引擎**:
   - **方式 A (推荐)**: 双击 `_studio/启动管理后台(server.py).bat`。
   - **方式 B (命令行)**: `python _studio/server.py` (这会调用 `_studio` 中的逻辑)。

---

## 6. 管理员指南 (Admin Guide)

### 6.1 快捷脚本 (Shortcut Scripts)
在 `_studio/` 目录下提供了一系列批处理工具：
- `启动管理后台(server.py).bat`: 一键启动 Python 服务并打开浏览器。
- `清理垃圾数据(clean-data.py).bat`: 扫描并清理数据库中不存在的图片、孤儿文件和无效记录。
- `清空所有数据(wipe-data.py).bat`: **危险操作**。一键抹除所有用户数据，将系统恢复至初始安装状态。
- `快捷打开文件(open-file.py).bat`: 快速定位到内容所在的物理路径。

### 6.2 核心操作 (Core Operations)
- **内容编辑**: 访问 `/admin-cms.html`，管理端将操作同步至 SQLite 索引与物理 Markdown 文件。
- **数据同步**: 编辑操作会自动触发文件名同步改名，并重写 `data/*.json` 静态索引。
- **外部接入**: 可直接在 VS Code 中编辑 `data/` 下的文件，网页端将实时反映变更内容。
